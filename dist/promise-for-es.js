/**
 * promise-for-es
 * @version 1.0.0
 * @author Ambit tsai <ambit_tsai@qq.com>
 * @license Apache-2.0
 * @see {@link https://github.com/ambit-tsai/promise-for-es#readme}
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Promise=t()}(this,(function(){"use strict";var e,t,n,r="object"==typeof window?window:"object"==typeof global?global:self,o=undefined;try{e=Function("iterable","callback","var i = 0;for (var element of iterable) {  callback(element, i++, iterable);}")}catch(j){e=function(e,t){for(var n=0,r=e.length;n<r;++n)t(e[n],n++,e)}}function i(e){return"function"==typeof e}function c(e){return!!e&&("object"==typeof e||i(e))}function a(e){throw new TypeError(e)}function l(e){a("Promise."+e+" called on non-object")}i(r.AggregateError)?t=r.AggregateError:(t=function(e,t){this.errors=e,this.message=t}).prototype=Error.prototype;try{Object.defineProperty({},"",{}),n=function(e,t,n,r){void 0===r&&(r=!1),Object.defineProperty(e,t,{configurable:!r,value:n})}}catch(j){n=function(e,t,n){return e[t]=n}}var u,s=r.MutationObserver||r.WebKitMutationObserver;function f(e,t){var n=e.Capability,r=e.Handler;try{var o=void 0;if(r)o=r(t);else{if("Reject"===e.Type)throw t;o=t}n.Resolve(o)}catch(j){n.Reject(j)}}function v(e){var t=!1;return{resolve:function(r){if(!t){t=!0;try{if(r===e&&a("Chaining cycle detected for promise"),c(r)){var l=r.then;if(i(l))return void u(d,[e,r,l])}!function(e,t){n(e,"_state","fulfilled",!0),n(e,"_result",t,!0);var r=e._fulfillReactions;n(e,"_fulfillReactions",o,!0),n(e,"_rejectReactions",o,!0),p(r,t)}(e,r)}catch(j){h(e,j)}}},reject:function(n){t||(t=!0,h(e,n))}}}function h(e,t){n(e,"_state","rejected",!0),n(e,"_result",t,!0);var r=e._rejectReactions;n(e,"_fulfillReactions",o,!0),n(e,"_rejectReactions",o,!0),e._isHandled,p(r,t)}function p(e,t){for(var n=0,r=e;n<r.length;n++){var o=r[n];u(f,[o,t])}}function d(e,t,n){var r=v(e),o=r.resolve,i=r.reject;try{n.call(t,o,i)}catch(j){i(j)}}function y(e){i(e)&&c(e.prototype)||a("call on non-constructor");var t={};return t.Promise=new e((function(e,n){t.Resolve=e,t.Reject=n})),i(t.Resolve)&&i(t.Reject)||a("Promise resolve or reject function is not callable"),t}return u=s?function(e,t){var n=new s((function(){e.apply(o,t),n.disconnect()})),r=document.createElement("a");n.observe(r,{attributes:!0}),r.setAttribute("b","")}:function(e,t){setTimeout((function(){return e.apply(o,t)}))},function(){function r(e){var t=this;t instanceof r||a("call Promise constructor without 'new'"),i(e)||a("argument is not a function"),n(t,"_state","pending"),n(t,"_fulfillReactions",[]),n(t,"_rejectReactions",[]),n(t,"_result",o),n(t,"_isHandled",!1);var c=v(t),l=c.resolve,u=c.reject;try{e(l,u)}catch(j){u(j)}}return r.prototype.then=function(e,t){var c=this;c instanceof r||a("Promise.prototype.then called on incompatible object");var l=y(r),s={Capability:l,Type:"Fulfill",Handler:i(e)?e:o},v={Capability:l,Type:"Reject",Handler:i(t)?t:o};return"pending"===c._state?(c._fulfillReactions.push(s),c._rejectReactions.push(v)):"fulfilled"===c._state?u(f,[s,c._result]):(c._isHandled,u(f,[v,c._result])),n(c,"_isHandled",!0),l.Promise},r.prototype["catch"]=function(e){return this.then(o,e)},r.prototype["finally"]=function(e){var t,n,r=this;return i(e)?(t=function(t){var n=e();return r.constructor.resolve(n).then((function(){return t}))},n=function(t){var n=e();return r.constructor.resolve(n).then((function(){throw t}))}):(t=e,n=e),r.then(t,n)},r.prototype.toString=function(){return"[object Promise]"},r.prototype.toLocaleString=function(){return"[object Promise]"},r.resolve=function(e){var t=this;if(c(t)||l("resolve"),c(e)&&e instanceof t)return e;var n=y(t);return n.Resolve(e),n.Promise},r.reject=function(e){c(this)||l("reject");var t=y(this);return t.Reject(e),t.Promise},r.all=function(t){var n=this;c(n)||l("all");var r=y(n);try{var o=0,i=[];e(t,(function(e,t){o++,n.resolve(e).then((function(e){i[t]=e,--o||r.Resolve(i)}),r.Reject)})),o?i.length=o:r.Resolve(i)}catch(j){r.Reject(j)}return r.Promise},r.race=function(t){var n=this;c(n)||l("race");var r=y(n);try{e(t,(function(e){n.resolve(e).then(r.Resolve,r.Reject)}))}catch(j){r.Reject(j)}return r.Promise},r.allSettled=function(t){var n=this;c(n)||l("allSettled");var r=y(n);try{var o=0,i=[];e(t,(function(e,t){o++,n.resolve(e).then((function(e){i[t]={status:"fulfilled",value:e},--o||r.Resolve(i)}),(function(e){i[t]={status:"rejected",reason:e},--o||r.Resolve(i)}))})),o?i.length=o:r.Resolve(i)}catch(j){r.Reject(j)}return r.Promise},r.any=function(n){var r=this;c(r)||l("any");var o=y(r);try{var i=0,a=[],u="All Promises rejected";e(n,(function(e,n){i++,r.resolve(e).then(o.Resolve,(function(e){a[n]=e,--i||o.Reject(new t(a,u))}))})),i?a.length=i:o.Reject(new t(a,u))}catch(j){o.Reject(j)}return o.Promise},r}()}));
//# sourceMappingURL=promise-for-es.js.map
