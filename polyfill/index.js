/**
 * promise-for-es
 * @version 1.0.0
 * @author Ambit tsai <ambit_tsai@qq.com>
 * @license Apache-2.0
 * @see {@link https://github.com/ambit-tsai/promise-for-es#readme}
 */
!function(){"use strict";var e,t,r,n="object"==typeof window?window:"object"==typeof global?global:self,o=undefined;try{e=Function("iterable","callback","var i = 0;for (var element of iterable) {  callback(element, i++, iterable);}")}catch(m){e=function(e,t){for(var r=0,n=e.length;r<n;++r)t(e[r],r++,e)}}function i(e){return"function"==typeof e}function c(e){return!!e&&("object"==typeof e||i(e))}function a(e){throw new TypeError(e)}function l(e){a("Promise."+e+" called on non-object")}i(n.AggregateError)?t=n.AggregateError:(t=function(e,t){this.errors=e,this.message=t}).prototype=Error.prototype;try{Object.defineProperty({},"",{}),r=function(e,t,r,n){void 0===n&&(n=!1),Object.defineProperty(e,t,{configurable:!n,value:r})}}catch(m){r=function(e,t,r){return e[t]=r}}var s,u=n.MutationObserver||n.WebKitMutationObserver;function f(e,t){var r=e.Capability,n=e.Handler;try{var o=void 0;if(n)o=n(t);else{if("Reject"===e.Type)throw t;o=t}r.Resolve(o)}catch(m){r.Reject(m)}}function v(e){var t=!1;return{resolve:function(n){if(!t){t=!0;try{if(n===e&&a("Chaining cycle detected for promise"),c(n)){var l=n.then;if(i(l))return void s(y,[e,n,l])}!function(e,t){r(e,"_state","fulfilled",!0),r(e,"_result",t,!0);var n=e._fulfillReactions;r(e,"_fulfillReactions",o,!0),r(e,"_rejectReactions",o,!0),h(n,t)}(e,n)}catch(m){p(e,m)}}},reject:function(r){t||(t=!0,p(e,r))}}}function p(e,t){r(e,"_state","rejected",!0),r(e,"_result",t,!0);var n=e._rejectReactions;r(e,"_fulfillReactions",o,!0),r(e,"_rejectReactions",o,!0),e._isHandled,h(n,t)}function h(e,t){for(var r=0,n=e;r<n.length;r++){var o=n[r];s(f,[o,t])}}function y(e,t,r){var n=v(e),o=n.resolve,i=n.reject;try{r.call(t,o,i)}catch(m){i(m)}}function j(e){i(e)&&c(e.prototype)||a("call on non-constructor");var t={};return t.Promise=new e((function(e,r){t.Resolve=e,t.Reject=r})),i(t.Resolve)&&i(t.Reject)||a("Promise resolve or reject function is not callable"),t}s=u?function(e,t){var r=new u((function(){e.apply(o,t),r.disconnect()})),n=document.createElement("a");r.observe(n,{attributes:!0}),n.setAttribute("b","")}:function(e,t){setTimeout((function(){return e.apply(o,t)}))};var d=function(){function n(e){var t=this;t instanceof n||a("call Promise constructor without 'new'"),i(e)||a("argument is not a function"),r(t,"_state","pending"),r(t,"_fulfillReactions",[]),r(t,"_rejectReactions",[]),r(t,"_result",o),r(t,"_isHandled",!1);var c=v(t),l=c.resolve,s=c.reject;try{e(l,s)}catch(m){s(m)}}return n.prototype.then=function(e,t){var c=this;c instanceof n||a("Promise.prototype.then called on incompatible object");var l=j(n),u={Capability:l,Type:"Fulfill",Handler:i(e)?e:o},v={Capability:l,Type:"Reject",Handler:i(t)?t:o};return"pending"===c._state?(c._fulfillReactions.push(u),c._rejectReactions.push(v)):"fulfilled"===c._state?s(f,[u,c._result]):(c._isHandled,s(f,[v,c._result])),r(c,"_isHandled",!0),l.Promise},n.prototype["catch"]=function(e){return this.then(o,e)},n.prototype["finally"]=function(e){var t,r,n=this;return i(e)?(t=function(t){var r=e();return n.constructor.resolve(r).then((function(){return t}))},r=function(t){var r=e();return n.constructor.resolve(r).then((function(){throw t}))}):(t=e,r=e),n.then(t,r)},n.prototype.toString=function(){return"[object Promise]"},n.prototype.toLocaleString=function(){return"[object Promise]"},n.resolve=function(e){var t=this;if(c(t)||l("resolve"),c(e)&&e instanceof t)return e;var r=j(t);return r.Resolve(e),r.Promise},n.reject=function(e){c(this)||l("reject");var t=j(this);return t.Reject(e),t.Promise},n.all=function(t){var r=this;c(r)||l("all");var n=j(r);try{var o=0,i=[];e(t,(function(e,t){o++,r.resolve(e).then((function(e){i[t]=e,--o||n.Resolve(i)}),n.Reject)})),o?i.length=o:n.Resolve(i)}catch(m){n.Reject(m)}return n.Promise},n.race=function(t){var r=this;c(r)||l("race");var n=j(r);try{e(t,(function(e){r.resolve(e).then(n.Resolve,n.Reject)}))}catch(m){n.Reject(m)}return n.Promise},n.allSettled=function(t){var r=this;c(r)||l("allSettled");var n=j(r);try{var o=0,i=[];e(t,(function(e,t){o++,r.resolve(e).then((function(e){i[t]={status:"fulfilled",value:e},--o||n.Resolve(i)}),(function(e){i[t]={status:"rejected",reason:e},--o||n.Resolve(i)}))})),o?i.length=o:n.Resolve(i)}catch(m){n.Reject(m)}return n.Promise},n.any=function(r){var n=this;c(n)||l("any");var o=j(n);try{var i=0,a=[],s="All Promises rejected";e(r,(function(e,r){i++,n.resolve(e).then(o.Resolve,(function(e){a[r]=e,--i||o.Reject(new t(a,s))}))})),i?a.length=i:o.Reject(new t(a,s))}catch(m){o.Reject(m)}return o.Promise},n}();if(n.Promise){for(var R in d)R in Promise||(Promise[R]=d[R]);for(var R in d.prototype)R in Promise.prototype||(Promise.prototype[R]=d.prototype[R])}else n.Promise=d}();
//# sourceMappingURL=index.js.map
